<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ† PLAY.G ì‡¼í•‘ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Arial, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; color: #333;
        }
        .container { 
            max-width: 1400px; margin: 0 auto; background: white; 
            border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.1); 
            overflow: hidden; margin: 20px auto;
        }
        .header { 
            background: linear-gradient(135deg, #ff6b6b, #ee5a24); 
            color: white; padding: 20px 30px; text-align: center;
        }
        .header h1 { font-size: 2.2em; margin-bottom: 5px; }
        .header p { font-size: 1.1em; opacity: 0.9; }

        .main-controls { 
            padding: 20px 30px; background: #f8f9fa; display: flex; 
            gap: 15px; align-items: center; flex-wrap: wrap; border-bottom: 1px solid #e9ecef;
        }
        .control-group { display: flex; align-items: center; gap: 8px; }
        .control-group label { font-weight: 600; color: #495057; font-size: 14px; }
        select, button { 
            padding: 8px 12px; border: 2px solid #e9ecef; 
            border-radius: 6px; font-size: 13px; transition: all 0.3s;
        }
        select:focus { outline: none; border-color: #007bff; }
        
        .action-buttons { margin-left: auto; display: flex; gap: 10px; }
        .btn-primary { 
            background: #28a745; color: white; border: none; 
            cursor: pointer; font-weight: 600; padding: 10px 20px;
        }
        .btn-primary:hover { background: #218838; transform: translateY(-1px); }
        .btn-secondary { 
            background: #17a2b8; color: white; border: none; 
            cursor: pointer; font-weight: 600; padding: 10px 20px;
        }
        .btn-secondary:hover { background: #138496; }

        .tab-container { display: flex; background: #f8f9fa; }
        .tab { 
            flex: 1; padding: 15px; background: #e9ecef; border: none; 
            cursor: pointer; font-size: 15px; font-weight: 600; transition: all 0.3s;
        }
        .tab.active { background: white; color: #007bff; border-bottom: 3px solid #007bff; }
        .tab:hover:not(.active) { background: #dee2e6; }

        .content { display: none; }
        .content.active { display: block; }

        /* ë­í‚¹ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .ranking-section { padding: 20px; }
        .stats-bar { 
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px; background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 8px; margin-bottom: 20px;
        }
        .stats-info { display: flex; gap: 30px; }
        .stat-item { text-align: center; }
        .stat-number { font-size: 1.4em; font-weight: bold; color: #007bff; }
        .stat-label { font-size: 0.85em; color: #6c757d; margin-top: 3px; }

        .ranking-table { 
            width: 100%; border-collapse: collapse; margin-top: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .ranking-table th { 
            background: #343a40; color: white; padding: 12px 8px; 
            text-align: left; font-size: 13px; position: sticky; top: 0; z-index: 10;
        }
        .ranking-table td { 
            padding: 10px 8px; border-bottom: 1px solid #e9ecef; font-size: 12px;
        }
        .ranking-table tbody tr:hover { background: #f8f9fa; }
        .rank-badge { 
            background: linear-gradient(135deg, #ff6b6b, #ee5a24); 
            color: white; padding: 4px 8px; border-radius: 12px; 
            font-weight: bold; display: inline-block; min-width: 30px; text-align: center;
        }
        .rank-badge.top3 { background: linear-gradient(135deg, #ffd700, #ffb700); }
        .price { font-weight: bold; color: #e74c3c; }
        .rating { color: #f39c12; font-weight: bold; }

        /* ë¶„ì„ ë³´ê³ ì„œ ìŠ¤íƒ€ì¼ */
        .analysis-section { padding: 20px; max-height: 70vh; overflow-y: auto; }
        .report-header { 
            text-align: center; padding: 20px; background: #f8f9fa; 
            border-radius: 8px; margin-bottom: 20px;
        }
        .report-section { 
            margin-bottom: 25px; padding: 20px; background: white; 
            border: 1px solid #e9ecef; border-radius: 8px;
        }
        .report-section h3 { 
            color: #495057; border-bottom: 2px solid #007bff; 
            padding-bottom: 8px; margin-bottom: 15px;
        }
        .insight-grid { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 15px; margin: 15px 0;
        }
        .insight-card { 
            padding: 15px; background: #f8f9fa; border-radius: 6px; 
            border-left: 4px solid #007bff;
        }
        .insight-card h4 { color: #495057; margin-bottom: 8px; font-size: 14px; }
        .insight-card p { font-size: 13px; line-height: 1.4; }

        .loading { text-align: center; padding: 40px; }
        .loading-spinner { 
            width: 40px; height: 40px; border: 4px solid #f3f3f3; 
            border-top: 4px solid #007bff; border-radius: 50%; 
            animation: spin 1s linear infinite; margin: 0 auto 15px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .error { 
            background: #f8d7da; color: #721c24; padding: 20px; 
            border-radius: 8px; margin: 20px; border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .main-controls { flex-direction: column; align-items: stretch; }
            .action-buttons { margin-left: 0; justify-content: center; }
            .stats-info { flex-direction: column; gap: 15px; text-align: center; }
            .ranking-table { font-size: 11px; }
            .ranking-table th, .ranking-table td { padding: 6px 4px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ† ê³ ê¸‰ ì‡¼í•‘ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h1>
            <p>íŒë§¤ìˆœìœ„ 1-150ìœ„ & AI ì œí’ˆ ë¶„ì„ ë³´ê³ ì„œ</p>
        </div>

        <div class="main-controls">
            <div class="control-group">
                <label for="category">ì¹´í…Œê³ ë¦¬:</label>
                <select id="category">
                    <option value="ì „ì²´">ì „ì²´</option>
                    <option value="íŒ¨ì…˜ì˜ë¥˜">íŒ¨ì…˜ì˜ë¥˜</option>
                    <option value="í™”ì¥í’ˆ/ë·°í‹°">í™”ì¥í’ˆ/ë·°í‹°</option>
                    <option value="ë””ì§€í„¸/ê°€ì „">ë””ì§€í„¸/ê°€ì „</option>
                    <option value="ìƒí™œìš©í’ˆ">ìƒí™œìš©í’ˆ</option>
                    <option value="ì‹í’ˆ/ê±´ê°•ì‹í’ˆ">ì‹í’ˆ/ê±´ê°•ì‹í’ˆ</option>
                    <option value="ë„ì„œ/ìŒë°˜">ë„ì„œ/ìŒë°˜</option>
                    <option value="ìŠ¤í¬ì¸ /ë ˆì €">ìŠ¤í¬ì¸ /ë ˆì €</option>
                    <option value="ìë™ì°¨ìš©í’ˆ">ìë™ì°¨ìš©í’ˆ</option>
                    <option value="ìœ ì•„/ì•„ë™">ìœ ì•„/ì•„ë™</option>
                    <option value="ë°˜ë ¤ë™ë¬¼">ë°˜ë ¤ë™ë¬¼</option>
                    <option value="í™ˆì¸í…Œë¦¬ì–´">í™ˆì¸í…Œë¦¬ì–´</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="platform">í”Œë«í¼:</label>
                <select id="platform">
                    <option value="all">ì „ì²´</option>
                    <option value="naver">ë„¤ì´ë²„ì‡¼í•‘</option>
                    <option value="coupang">ì¿ íŒ¡</option>
                    <option value="gmarket">ì§€ë§ˆì¼“</option>
                    <option value="auction">ì˜¥ì…˜</option>
                </select>
            </div>

            <div class="control-group">
                <label for="rankingType">ìˆœìœ„ìœ í˜•:</label>
                <select id="rankingType">
                    <option value="sales">íŒë§¤ìˆœìœ„</option>
                    <option value="recommend">ì¶”ì²œìˆœìœ„</option>
                    <option value="review">ë¦¬ë·°ìˆœìœ„</option>
                    <option value="rating">í‰ì ìˆœìœ„</option>
                </select>
            </div>

            <div class="action-buttons">
                <button class="btn-primary" onclick="loadRankings()">ğŸ”„ ë°ì´í„° ìƒˆë¡œê³ ì¹¨</button>
                <button class="btn-secondary" onclick="downloadExcel()">ğŸ“Š ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
            </div>
        </div>

        <div class="tab-container">
            <button class="tab active" onclick="switchTab('rankings')">ğŸ† ìˆœìœ„ ë­í‚¹ (1-150ìœ„)</button>
            <button class="tab" onclick="switchTab('analysis')">ğŸ“Š ì œí’ˆ ë¶„ì„ ë³´ê³ ì„œ</button>
        </div>

        <!-- ìˆœìœ„ ë­í‚¹ ì„¹ì…˜ -->
        <div id="rankings-content" class="content active">
            <div class="ranking-section">
                <div class="stats-bar">
                    <div class="stats-info">
                        <div class="stat-item">
                            <div class="stat-number" id="total-products">150</div>
                            <div class="stat-label">ì „ì²´ ìƒí’ˆìˆ˜</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="avg-price">-</div>
                            <div class="stat-label">í‰ê·  ê°€ê²©</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="avg-rating">-</div>
                            <div class="stat-label">í‰ê·  í‰ì </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="total-reviews">-</div>
                            <div class="stat-label">ì´ ë¦¬ë·°ìˆ˜</div>
                        </div>
                    </div>
                    <div style="text-align: right; color: #6c757d; font-size: 0.85em;">
                        <div>ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸</div>
                        <div id="last-updated">-</div>
                    </div>
                </div>

                <div style="overflow-x: auto;">
                    <table class="ranking-table">
                        <thead>
                            <tr>
                                <th>ìˆœìœ„</th>
                                <th>ìƒí’ˆëª…</th>
                                <th>ì¹´í…Œê³ ë¦¬</th>
                                <th>ë¸Œëœë“œ</th>
                                <th>ê°€ê²©</th>
                                <th>í• ì¸ìœ¨</th>
                                <th>í‰ì </th>
                                <th>ë¦¬ë·°</th>
                                <th>íŒë§¤ëŸ‰</th>
                                <th>íŒë§¤ì</th>
                                <th>í”Œë«í¼</th>
                            </tr>
                        </thead>
                        <tbody id="ranking-table-body">
                            <!-- ë°ì´í„°ê°€ ì—¬ê¸°ì— ë“¤ì–´ê°‘ë‹ˆë‹¤ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ì œí’ˆ ë¶„ì„ ë³´ê³ ì„œ ì„¹ì…˜ -->
        <div id="analysis-content" class="content">
            <div class="analysis-section">
                <div class="report-header">
                    <h2>ğŸ” AI ì œí’ˆ ë¶„ì„ ë³´ê³ ì„œ</h2>
                    <p>ì‹œì¥ í¬ì§€ì…”ë‹ë¶€í„° ì‹ ì œí’ˆ ì¶œì‹œ ì „ëµê¹Œì§€ ì¢…í•© ë¶„ì„</p>
                    <div style="margin-top: 15px;">
                        <input type="text" id="product-name" placeholder="ë¶„ì„í•  ì œí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”" 
                               style="padding: 10px; width: 300px; border: 2px solid #e9ecef; border-radius: 6px;">
                        <button class="btn-primary" onclick="generateAnalysis()" style="margin-left: 10px;">
                            ğŸš€ ë¶„ì„ ì‹œì‘
                        </button>
                    </div>
                </div>

                <div id="analysis-report">
                    <div style="text-align: center; padding: 40px; color: #6c757d;">
                        <h3>ì œí’ˆëª…ì„ ì…ë ¥í•˜ê³  'ë¶„ì„ ì‹œì‘' ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</h3>
                        <p>AIê°€ ì¢…í•©ì ì¸ ì‹œì¥ ë¶„ì„ ë³´ê³ ì„œë¥¼ ìƒì„±í•´ë“œë¦½ë‹ˆë‹¤</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentTab = 'rankings';
        let currentData = null;

        // íƒ­ ì „í™˜
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
            
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.getElementById(`${tab}-content`).classList.add('active');
            
            currentTab = tab;
        }

        // ë­í‚¹ ë°ì´í„° ë¡œë“œ
        async function loadRankings() {
            const category = document.getElementById('category').value;
            const platform = document.getElementById('platform').value;
            const type = document.getElementById('rankingType').value;
            
            const tableBody = document.getElementById('ranking-table-body');
            tableBody.innerHTML = '<tr><td colspan="11" style="text-align: center; padding: 30px;"><div class="loading-spinner"></div>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</td></tr>';
            
            try {
                const response = await fetch(`/api/rankings?category=${encodeURIComponent(category)}&platform=${platform}&type=${type}`);
                const data = await response.json();
                
                if (data.success) {
                    currentData = data;
                    displayRankings(data.rankings);
                    updateStats(data.rankings);
                    document.getElementById('last-updated').textContent = new Date(data.lastUpdated).toLocaleString();
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                console.error('ë­í‚¹ ë¡œë“œ ì˜¤ë¥˜:', error);
                tableBody.innerHTML = `<tr><td colspan="11" style="text-align: center; padding: 30px; color: #dc3545;">ì˜¤ë¥˜: ${error.message}</td></tr>`;
            }
        }

        // ë­í‚¹ ë°ì´í„° í‘œì‹œ
        function displayRankings(rankings) {
            const tableBody = document.getElementById('ranking-table-body');
            
            tableBody.innerHTML = rankings.map(item => `
                <tr>
                    <td><span class="rank-badge ${item.rank <= 3 ? 'top3' : ''}">${item.rank}</span></td>
                    <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" 
                        title="${item.productName}">${item.productName}</td>
                    <td>${item.category}</td>
                    <td>${item.brand}</td>
                    <td class="price">${item.price.toLocaleString()}ì›</td>
                    <td style="color: #e74c3c; font-weight: bold;">${item.discountRate}%</td>
                    <td class="rating">â­ ${item.rating}</td>
                    <td>${item.reviewCount.toLocaleString()}</td>
                    <td>${item.salesVolume.toLocaleString()}</td>
                    <td title="${item.seller.name} (${item.seller.rating}â­)">${item.seller.name}</td>
                    <td>${item.platform}</td>
                </tr>
            `).join('');
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats(rankings) {
            const avgPrice = rankings.reduce((sum, item) => sum + item.price, 0) / rankings.length;
            const avgRating = rankings.reduce((sum, item) => sum + parseFloat(item.rating), 0) / rankings.length;
            const totalReviews = rankings.reduce((sum, item) => sum + item.reviewCount, 0);
            
            document.getElementById('avg-price').textContent = Math.floor(avgPrice).toLocaleString() + 'ì›';
            document.getElementById('avg-rating').textContent = avgRating.toFixed(1);
            document.getElementById('total-reviews').textContent = totalReviews.toLocaleString();
        }

        // ë¶„ì„ ë³´ê³ ì„œ ìƒì„±
        async function generateAnalysis() {
            const productName = document.getElementById('product-name').value.trim();
            if (!productName) {
                alert('ë¶„ì„í•  ì œí’ˆëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const reportDiv = document.getElementById('analysis-report');
            reportDiv.innerHTML = '<div class="loading"><div class="loading-spinner"></div><p>AIê°€ ì¢…í•© ë¶„ì„ ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p></div>';
            
            try {
                const category = document.getElementById('category').value;
                const platform = document.getElementById('platform').value;
                
                const response = await fetch(`/api/advanced-analysis?product=${encodeURIComponent(productName)}&category=${encodeURIComponent(category)}&platform=${platform}`);
                const data = await response.json();
                
                if (data.success) {
                    displayAnalysisReport(data.analysis);
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                console.error('ë¶„ì„ ìƒì„± ì˜¤ë¥˜:', error);
                reportDiv.innerHTML = `<div class="error"><h3>ì˜¤ë¥˜ ë°œìƒ</h3><p>${error.message}</p></div>`;
            }
        }

        // ë¶„ì„ ë³´ê³ ì„œ í‘œì‹œ
        function displayAnalysisReport(analysis) {
            const reportDiv = document.getElementById('analysis-report');
            
            reportDiv.innerHTML = `
                <div class="report-section">
                    <h3>ğŸ“Š ë¶„ì„ ëŒ€ìƒ: ${analysis.productName}</h3>
                    <p>ì¹´í…Œê³ ë¦¬: ${analysis.category} | ë¶„ì„ì¼: ${new Date(analysis.analysisDate).toLocaleDateString()}</p>
                </div>

                <div class="report-section">
                    <h3>ğŸ¯ 1. ì‹œì¥ í¬ì§€ì…”ë‹ ë¶„ì„</h3>
                    <div class="insight-grid">
                        <div class="insight-card">
                            <h4>ì£¼ íƒ€ê¹ƒ ê³ ê°</h4>
                            <p><strong>ì—°ë ¹:</strong> ${analysis.marketPositioning.targetCustomers.ageGroups.join(', ')}</p>
                            <p><strong>ì„±ë³„:</strong> ${analysis.marketPositioning.targetCustomers.gender}</p>
                            <p><strong>ì§€ì—­:</strong> ${analysis.marketPositioning.targetCustomers.regions.join(', ')}</p>
                        </div>
                        <div class="insight-card">
                            <h4>ê°€ê²©ëŒ€ ë¶„ì„</h4>
                            <p><strong>ì €ê°€:</strong> ${analysis.marketPositioning.priceSegment.lowEnd}</p>
                            <p><strong>ì¤‘ê°€:</strong> ${analysis.marketPositioning.priceSegment.midRange}</p>
                            <p><strong>ê³ ê°€:</strong> ${analysis.marketPositioning.priceSegment.highEnd}</p>
                            <p><strong>ê¶Œì¥ê°€ê²©:</strong> ${analysis.marketPositioning.priceSegment.recommendedPrice}</p>
                        </div>
                        <div class="insight-card">
                            <h4>í¬ì§€ì…”ë‹ ì „ëµ</h4>
                            <p><strong>ìµœì  ê³ ê°:</strong> ${analysis.marketPositioning.positioningStrategy.optimalCustomer}</p>
                            <p><strong>ìµœì  ê°€ê²©:</strong> ${analysis.marketPositioning.positioningStrategy.optimalPrice}</p>
                            <p><strong>ì „ëµ:</strong> ${analysis.marketPositioning.positioningStrategy.positioningAdvice}</p>
                        </div>
                    </div>
                </div>

                <div class="report-section">
                    <h3>âš¡ 2. ì œí’ˆ í¼í¬ë¨¼ìŠ¤ ìš”ì•½</h3>
                    <div class="insight-grid">
                        <div class="insight-card">
                            <h4>ì£¼ìš” ê°•ì </h4>
                            <p><strong>í‚¤ì›Œë“œ:</strong> ${analysis.performanceSummary.strengths.keywords.join(', ')}</p>
                            <ul style="margin-top: 8px; font-size: 12px;">
                                ${analysis.performanceSummary.strengths.topReasons.map(reason => `<li>${reason}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="insight-card">
                            <h4>ì•½ì  ë° ë¶ˆë§Œ</h4>
                            <p><strong>í‚¤ì›Œë“œ:</strong> ${analysis.performanceSummary.weaknesses.keywords.join(', ')}</p>
                            <ul style="margin-top: 8px; font-size: 12px;">
                                ${analysis.performanceSummary.weaknesses.mainComplaints.map(complaint => `<li>${complaint}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="insight-card">
                            <h4>í•µì‹¬ ì „ëµ</h4>
                            <p><strong>ì œí’ˆ:</strong> ${analysis.performanceSummary.coreStrategy.productFocus}</p>
                            <p><strong>ì„œë¹„ìŠ¤:</strong> ${analysis.performanceSummary.coreStrategy.serviceFocus}</p>
                            <p><strong>ë§ˆì¼€íŒ…:</strong> ${analysis.performanceSummary.coreStrategy.marketingFocus}</p>
                        </div>
                    </div>
                </div>

                <div class="report-section">
                    <h3>ğŸ“ˆ 3. ì‹œì¦Œë³„ íŒë§¤ ì¶”ì´</h3>
                    <div class="insight-grid">
                        <div class="insight-card">
                            <h4>í”¼í¬ ì‹œì¦Œ</h4>
                            ${analysis.seasonalTrends.peakSeasons.map(season => `
                                <p><strong>${season.period}:</strong> ${season.reason}</p>
                                <p style="font-size: 12px; color: #6c757d;">ì „ëµ: ${season.strategy}</p>
                            `).join('')}
                        </div>
                        <div class="insight-card">
                            <h4>ì›”ë³„ íŒë§¤ ì§€ìˆ˜</h4>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; font-size: 11px;">
                                ${analysis.seasonalTrends.yearlyTrend.map(month => `
                                    <div>${month.month}: ${month.salesIndex}</div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="report-section">
                    <h3>ğŸ’¡ 4. ê°œì„ Â·í˜ì‹  í¬ì¸íŠ¸</h3>
                    <div class="insight-grid">
                        <div class="insight-card">
                            <h4>ì œí’ˆ ê°œì„ </h4>
                            <ul style="font-size: 12px;">
                                ${analysis.innovationPoints.productImprovement.map(point => `<li>${point}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="insight-card">
                            <h4>íŒ¨í‚¤ì§•Â·ë¸Œëœë”©</h4>
                            <ul style="font-size: 12px;">
                                ${analysis.innovationPoints.packagingBranding.map(point => `<li>${point}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="insight-card">
                            <h4>ë””ì§€í„¸ ë§ˆì¼€íŒ…</h4>
                            <ul style="font-size: 12px;">
                                ${analysis.innovationPoints.digitalMarketing.map(point => `<li>${point}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="report-section">
                    <h3>ğŸŒ 5. ë²¤ì¹˜ë§ˆí‚¹ & í™•ì¥ ì „ëµ</h3>
                    <div class="insight-grid">
                        <div class="insight-card">
                            <h4>ê¸€ë¡œë²Œ ë²¤ì¹˜ë§ˆí‚¹</h4>
                            ${analysis.benchmarkingStrategy.globalCases.map(case_ => `
                                <p><strong>${case_.brand}:</strong> ${case_.strategy}</p>
                                <p style="font-size: 12px; color: #6c757d;">ì ìš©: ${case_.adaptation}</p>
                            `).join('')}
                        </div>
                        <div class="insight-card">
                            <h4>ì¸í”Œë£¨ì–¸ì„œ ì „ëµ</h4>
                            <ul style="font-size: 12px;">
                                ${analysis.benchmarkingStrategy.influencerStrategy.map(strategy => `<li>${strategy}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="insight-card">
                            <h4>ëŸ°ì¹­ ê³ ë ¤ì‚¬í•­</h4>
                            <ul style="font-size: 12px;">
                                ${analysis.benchmarkingStrategy.launchConsiderations.map(consideration => `<li>${consideration}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="report-section">
                    <h3>ğŸ¯ 6. ìì‚¬ ì‹ ì œí’ˆ ì¶œì‹œ ìµœì¢… ì˜ê²¬</h3>
                    <div class="insight-grid">
                        <div class="insight-card">
                            <h4>ëŸ°ì¹­ ì „ëµ</h4>
                            <p><strong>ìµœì  ì‹œê¸°:</strong> ${analysis.finalRecommendation.launchTiming}</p>
                            <p><strong>íƒ€ê¹ƒ ê°€ê²©:</strong> ${analysis.finalRecommendation.targetPrice}</p>
                        </div>
                        <div class="insight-card">
                            <h4>ì„±ê³µ ìš”ì¸</h4>
                            <ul style="font-size: 12px;">
                                ${analysis.finalRecommendation.keySuccess.map(factor => `<li>${factor}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="insight-card">
                            <h4>ë¦¬ìŠ¤í¬ & KPI</h4>
                            <p><strong>ì£¼ìš” ë¦¬ìŠ¤í¬:</strong></p>
                            <ul style="font-size: 11px;">
                                ${analysis.finalRecommendation.riskFactors.map(risk => `<li>${risk}</li>`).join('')}
                            </ul>
                            <p><strong>ì„±ê³µ KPI:</strong></p>
                            <ul style="font-size: 11px;">
                                ${analysis.finalRecommendation.successKPIs.map(kpi => `<li>${kpi}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                </div>
            `;
        }

        // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
        function downloadExcel() {
            const category = document.getElementById('category').value;
            const type = document.getElementById('rankingType').value;
            
            const link = document.createElement('a');
            link.href = `/api/download-excel?category=${encodeURIComponent(category)}&type=${type}`;
            link.download = '';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.getElementById('category').addEventListener('change', loadRankings);
        document.getElementById('platform').addEventListener('change', loadRankings);
        document.getElementById('rankingType').addEventListener('change', loadRankings);

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ë°ì´í„° ë¡œë“œ
        document.addEventListener('DOMContentLoaded', function() {
            loadRankings();
        });
    </script>
</body>
</html>
